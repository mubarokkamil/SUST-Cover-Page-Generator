<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SUST Cover Page Generator</title>
  <meta name="description" content="Official SUST Cover Sheet Generator • Shahjalal University of Science and Technology">
  <meta name="keywords" content="SUST cover page, SUST assignment cover page, SUST cover sheet, SUST lab report cover page generator, Shahjalal University of Science and Technology, SUST form, SUST template, SUST pdf generator">
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  <meta property="og:title" content="SUST Cover Page Generator">
  <meta property="og:description" content="Instantly generate SUST assignment and lab report cover pages. Free tool for EEE SUST students.">
  <meta property="og:image" content="https://mubarokkamil.github.io/SUST-Cover-Page-Generator/sust_logo.png">
  <meta property="og:url" content="https://mubarokkamil.github.io/SUST-Cover-Page-Generator/">
  <meta property="og:type" content="website">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="SUST Cover Page Generator">
  <meta name="twitter:description" content="Generate official SUST cover pages instantly—free for all SUST students.">
  <meta name="twitter:image" content="https://mubarokkamil.github.io/SUST-Cover-Page-Generator/sust_logo.png">

  <link rel="canonical" href="https://mubarokkamil.github.io/SUST-Cover-Page-Generator/">

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-MPCRSKJK05"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MPCRSKJK05');
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,600;1,400&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --sust-navy: #0A2647;
      --sust-blue: #003366;
      --sust-gold: #D4AF37;
      --border: #cbd5e1;
      --shadow: 0 12px 35px rgba(10, 38, 71, 0.12);
      --success: #2d6a4f;
      --error: #9B1D41;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background-color: #f5f7fa;
      padding: 1rem;
      line-height: 1.6;
      color: #333;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    /* === Main Container & Page Visibility === */
    .hidden {
      display: none !important;
    }
    
    .page-container {
      max-width: 800px; /* Original max-width */
      width: 100%;
      margin: auto;
      background: white;
      border-radius: 1.25rem;
      overflow: hidden;
      box-shadow: var(--shadow);
    }
    
    /* Widen container on Generator Page for 2-col layout */
    #generatorPage {
      max-width: 1200px;
    }
    
    /* === Shared Header === */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      border-bottom: 1px solid #e2e8f0;
      background-color: #fdfdfd;
    }
    .header-logo { width: 60px; height: auto; flex-shrink: 0; }
    .header-text { text-align: right; color: var(--sust-navy); }
    .header-text h1 { font-family: 'EB Garamond', Georgia, serif; font-size: 1.5rem; font-weight: 600; margin: 0; }
    .header-text p { font-size: 0.9rem; opacity: 0.9; margin: 0; }


    /* === Landing Page Styles === */
    .landing-main { text-align: center; padding: 4rem 2rem; }
    .landing-main h2 { font-family: 'EB Garamond', serif; font-size: 2.25rem; color: var(--sust-navy); margin-bottom: 1rem; }
    .landing-main p { font-size: 1.125rem; color: #4a5568; max-width: 600px; margin: 0 auto 3rem auto; }
    .selection-grid { display: grid; grid-template-columns: 1fr; gap: 1.5rem; }
    .selection-box { cursor: pointer; display: block; padding: 2rem; background-color: #f8fafc; border: 2px solid var(--border); border-radius: 0.75rem; text-decoration: none; color: var(--sust-blue); transition: all 0.3s ease; }
    .selection-box:hover { border-color: var(--sust-gold); transform: translateY(-5px); box-shadow: 0 8px 25px rgba(212, 175, 55, 0.15); background-color: #fff; }
    .selection-box h3 { font-family: 'EB Garamond', serif; font-size: 1.5rem; margin-bottom: 0.5rem; }
    .selection-box span { font-size: 1rem; color: #4a5568; }

    /* === Video Styles === */
    .video-container {
        position: relative;
        overflow: hidden;
        width: 100%;
        padding-top: 56.25%; /* 16:9 Aspect Ratio */
        margin: 3rem auto 0 auto; /* Adjusted margin to add space above */
        border-radius: 0.75rem;
        box-shadow: var(--shadow);
    }
    .video-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: 0;
    }

    /* === Generator Page Styles === */
    .generator-main { padding: 2.5rem 1.5rem; }
    .generator-main h3 { font-family: 'EB Garamond', serif; font-size: 1.75rem; color: var(--sust-navy); text-align: center; margin-bottom: 2.5rem; font-weight: 600; }
    .form-grid { display: grid; grid-template-columns: 1fr; gap: 1.375rem; }
    label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: #2d3748; font-size: 0.9375rem; }
    input { width: 100%; padding: 1rem 1.125rem; border: 2px solid var(--border); border-radius: 0.75rem; font-size: 0.9375rem; background: #fdfdfd; transition: all 0.3s ease; }
    input:focus { outline: none; border-color: var(--sust-gold); box-shadow: 0 0 0 0.3125rem rgba(212, 175, 55, 0.15); background: white; }
    .field-group { padding: 1.5625rem; background: #f9fbfc; border-radius: 0.875rem; border: 1.5px dashed var(--border); margin-top: 1.5625rem; opacity: 0; max-height: 0; overflow: hidden; transition: all 0.5s ease-in-out; visibility: hidden; }
    .field-group.visible { opacity: 1; max-height: 500px; border-style: solid; border-color: var(--sust-gold); background: #fefef9; visibility: visible; }
    button { width: 100%; background: var(--sust-blue); color: white; padding: 1.125rem; border: none; border-radius: 0.75rem; font-size: 1.0625rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; margin-top: 2.1875rem; }
    button:hover:not(:disabled) { background: #002b55; transform: translateY(-3px); box-shadow: 0 10px 30px rgba(0, 51, 102, 0.3); }
    #status { margin-top: 1.5rem; text-align: center; font-weight: 500; padding: 0.875rem; border-radius: 0.625rem; min-height: 3.5rem; transition: all 0.3s; display: flex; align-items: center; justify-content: center; }
    .converter { margin-top: 2.8rem; text-align: center; padding: 1.875rem; background: #f0f4f8; border-radius: 0.875rem; border: 1px solid #d0d7e0; }
    
    /* === Shared Footer === */
    .page-footer { text-align: center; padding: 2rem 1rem; color: #64748b; font-size: 0.875rem; }
    .page-footer a { color: var(--sust-blue); text-decoration: none; font-weight: 500; }
    .page-footer a:hover { text-decoration: underline; }
    #backButton { cursor: pointer; }


    /* === Responsive Adjustments === */
    @media (max-width: 480px) {
        body { padding: 0.5rem; }
        .header { padding: 1rem 1.5rem; }
        .header-logo { width: 50px; }
        .header-text h1 { font-size: 1.2rem; }
        .header-text p { font-size: 0.8rem; }
        .landing-main { padding: 2.5rem 1rem; }
        .generator-main { padding: 2rem 1rem; }
    }
    @media (min-width: 768px) {
      .selection-grid { grid-template-columns: 1fr 1fr; }
      .form-grid { grid-template-columns: 1fr 1fr; }
      .header-logo { width: 70px; }
      .header-text h1 { font-size: 1.75rem; }
      .generator-main { padding: 3.4375rem 4.375rem; }
    }

    /* === [NEW] Generator Page Layout & Live Preview Styles === */
    .generator-layout {
      display: grid;
      grid-template-columns: 1fr; /* Default to 1 column */
      gap: 2.5rem;
    }

    .form-container {
      /* This container now holds the form and status */
      width: 100%;
    }

    #livePreviewContainer {
      width: 100%;
    }

    .preview-page {
      background: #ffffff;
      border: 1px solid #dfe6e9;
      border-radius: 0.5rem;
      padding: 2.5rem;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      font-family: 'EB Garamond', Georgia, serif;
      color: #333;
      min-height: 500px; /* Give it some height */
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      line-height: 1.5;
    }

    .preview-header {
      text-align: center;
      border-bottom: 2px solid #0A2647;
      padding-bottom: 1rem;
      margin-bottom: 2rem;
    }
    .preview-header .preview-logo {
      width: 50px;
      margin-bottom: 0.5rem;
    }
    .preview-header h2 {
      font-size: 1.5rem;
      font-weight: 600;
      color: #0A2647;
      margin: 0;
    }
    .preview-header p {
      font-size: 1rem;
      margin: 0;
    }
    .preview-header p strong {
      font-family: 'Inter', sans-serif; /* Use sans-serif for the dynamic part */
      font-weight: 600;
      color: #003366;
    }

    .preview-body {
      text-align: center;
      margin: 2rem 0;
      font-size: 1.2rem;
    }
    .preview-body p {
      margin: 0.25rem 0;
    }
    .preview-body strong {
      font-family: 'Inter', sans-serif;
      font-size: 1.3rem;
      color: #003366;
      font-weight: 600;
      display: block;
      margin-top: 0.25rem;
    }

    .preview-submission-details {
      font-family: 'Inter', sans-serif;
      font-size: 0.95rem;
    }

    .preview-field-group {
      display: grid;
      grid-template-columns: 120px 1fr; /* Label and Value */
      gap: 1rem;
      margin-bottom: 1rem;
      padding: 0.75rem;
      background: #f9fbfc;
      border-radius: 0.5rem;
      border: 1px solid #e2e8f0;
    }
    .preview-field-group .label {
      font-weight: 600;
      color: #0A2647;
    }
    .preview-field-group .value {
      color: #333;
      word-break: break-word;
    }
    .preview-field-group .value strong,
    .preview-field-group .value span {
      display: block;
    }
    .preview-field-group .value strong {
      font-size: 1.05rem;
      font-weight: 600;
    }
    .preview-field-group .value span {
      font-size: 0.9rem;
      color: #4a5568;
    }

    /* Adjustments for larger screens */
    @media (min-width: 768px) {
      .generator-main {
        /* Keep your existing padding */
        padding: 3.4375rem 4.375rem; 
      }
    }

    /* This is the key media query for the 2-column layout */
    @media (min-width: 1024px) {
      .generator-layout {
        grid-template-columns: 1fr 1fr; /* 2 columns on large screens */
      }
      #livePreviewContainer {
        /* Make the preview sticky on scroll */
        position: sticky;
        top: 2rem;
        align-self: start;
      }
    }

  </style>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "SUST Cover Page Generator",
    "url": "https://mubarokkamil.github.io/SUST-Cover-Page-Generator/",
    "description": "Official style cover page generator for SUST assignment and lab reports.",
    "applicationCategory": "EducationApplication",
    "operatingSystem": "All",
    "author": {
      "@type": "Person",
      "name": "Mubarok Hossen Kamil"
    }
  }
  </script>
</head>
<body>

  <div id="landingPage" class="page-container">
    <header class="header">
      <img src="sust_logo.png" alt="SUST Logo" class="header-logo">
      <div class="header-text">
        <h1>Shahjalal University of Science & Technology</h1>
        <p>Sylhet-3114, Bangladesh</p>
      </div>
    </header>
    <main class="landing-main">
      <h2>SUST Cover Page Generator</h2>
      <p>Please choose the type of cover page you would like to create. Your selection will take you to a form to enter your details.</p>
            
      <div class="selection-grid">
        <div class="selection-box" data-choice="lab">
          <h3>Lab Report</h3>
          <span>For practical courses and lab experiments.</span>
        </div>
        <div class="selection-box" data-choice="assignment">
          <h3>Assignment</h3>
          <span>For theoretical courses and general assignments.</span>
        </div>
      </div>

      <div class="video-container">
        <iframe src="https://www.youtube.com/embed/L9VrTpW3CGM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
      </div>
    </main>
  </div>

  <div id="generatorPage" class="page-container hidden">
    <header class="header">
      <img src="sust_logo.png" alt="SUST Logo" class="header-logo">
      <div class="header-text">
        <h1>Shahjalal University of Science & Technology</h1>
        <p>Sylhet-3114, Bangladesh</p>
      </div>
    </header>
    
    <main class="generator-main">
      <h3>Generate Your Official Cover Sheet</h3>
      
      <div class="generator-layout">
        
        <div class="form-container">
          <form id="dataForm">
            <input type="hidden" id="templateFile" value="">

            <div class="form-grid">
              <div>
                <label for="Dept_Name">Department</label>
                <input type="text" id="Dept_Name" list="dept-list" required placeholder="e.g. Electrical and Electronic Engineering">
                <datalist id="dept-list">
                  <option value="Anthropology">
                  <option value="Architecture">
                  <option value="Bangla">
                  <option value="Biochemistry and Molecular Biology">
                  <option value="Business Administration">
                  <option value="Chemical Engineering & Polymer Science">
                  <option value="Chemistry">
                  <option value="Civil & Environmental Engineering">
                  <option value="Computer Science & Engineering">
                  <option value="Economics">
                  <option value="Electrical & Electronic Engineering">
                  <option value="English">
                  <option value="Food Engineering & Tea Technology">
                  <option value="Forestry & Environmental Science">
                  <option value="Geography and Environment">
                  <option value="Genetic Engineering & Biotechnology">
                  <option value="Industrial & Production Engineering">
                  <option value="Mathematics">
                  <option value="Mechanical Engineering">
                  <option value="Oceanography">
                  <option value="Petroleum and Mining Engineering">
                  <option value="Physics">
                  <option value="Political Studies">
                  <option value="Public Administration">
                  <option value="Social Work">
                  <option value="Sociology">
                  <option value="Statistics">
                </datalist>
              </div>
              <div><label for="Course_Code">Course Code</label><input type="text" id="Course_Code" required placeholder="e.g. EEE 322"></div>
              <div><label for="Course_Title">Course Title</label><input type="text" id="Course_Title" required placeholder="e.g. Digital Signal Processing"></div>
              <div><label for="Course_Teacher">Course Teacher</label><input type="text" id="Course_Teacher" required placeholder="e.g. Dr. Muhammad Mostafa Amir Faisal"></div>
              <div><label for="Course_Teacher_Details">Teacher Designation</label><input type="text" id="Course_Teacher_Details" placeholder="e.g. Professor, Dept. of EEE, SUST"></div>
              <div><label for="Reg_No">Registration No.</label><input type="text" id="Reg_No" required placeholder="e.g. 2020331024"></div>
              <div><label for="Name">Student Name</label><input type="text" id="Name" required placeholder="e.g. Mohammad"></div>
            </div>

            <div id="labFields" class="field-group">
              <div class="form-grid">
                <div>
                  <label for="Exp_No">Experiment No.</label>
                  <input type="text" id="Exp_No" placeholder="e.g. 01">
                </div>
                <div>
                  <label for="Group_No">Group No</label>
                  <input type="text" id="Group_No" placeholder="e.g. Group A">
                </div>
                <div style="grid-column: 1 / -1;">
                  <label for="Exp_Name">Experiment Name</label>
                  <input type="text" id="Exp_Name" placeholder="e.g. Study of RC Circuit">
                </div>
              </div>
            </div>

            <div id="assignmentFields" class="field-group"><div class="form-grid"><div style="grid-column: 1 / -1;"><label for="Assignment_Name">Assignment Title</label><input type="text" id="Assignment_Name" placeholder="e.g. Assignment on Fourier Transform"></div></div></div>
            
            <button type="submit">Generate Cover Page</button>
          </form>
          <div id="status"></div>
        </div>

        <div id="livePreviewContainer">
          <div class="preview-page">
            <div class="preview-header">
              <img src="sust_logo.png" alt="SUST Logo" class="preview-logo">
              <h2>Shahjalal University of Science & Technology</h2>
              <p>Sylhet-3114, Bangladesh</p>
              <p>Department of <strong id="preview-Dept_Name">[Department]</strong></p>
            </div>

            <div class="preview-body">
              <div id="preview-lab-section" class="hidden">
                <p>Experiment No: <strong id="preview-Exp_No">[No]</strong></p>
                <p>Experiment Name: <strong id="preview-Exp_Name">[Experiment Name]</strong></p>
              </div>
              
              <div id="preview-assignment-section" class="hidden">
                <p>Assignment on:</p>
                <p><strong id="preview-Assignment_Name">[Assignment Title]</strong></p>
              </div>
            </div>

            <div class="preview-submission-details">
              <div class="preview-field-group">
                <span class="label">Course Code:</span>
                <span class="value" id="preview-Course_Code">[Code]</span>
              </div>
              <div class="preview-field-group">
                <span class="label">Course Title:</span>
                <span class="value" id="preview-Course_Title">[Title]</span>
              </div>

              <div class="preview-field-group submitted-to">
                <span class="label">Submitted To:</span>
                <span class="value">
                  <strong id="preview-Course_Teacher">[Teacher Name]</strong>
                  <span id="preview-Course_Teacher_Details">[Teacher Designation]</span>
                </span>
              </div>

              <div class="preview-field-group submitted-by">
                <span class="label">Submitted By:</span>
                <span class="value">
                  <strong id="preview-Name">[Student Name]</strong>
                  Reg No: <span id="preview-Reg_No">[Reg No]</span>
                  <span id="preview-Group_No_Container" class="hidden">
                    Group: <strong id="preview-Group_No">[Group]</strong>
                  </span>
                </span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="converter">
        <p>Need PDF format? Use an online converter.</p>
        <a href="https://www.ilovepdf.com/word_to_pdf" target="_blank" rel="noopener noreferrer" style="text-decoration: none;"><button type="button" style="background: #28a745; margin: 0; width: auto; padding: 0.75rem 2rem;">Convert DOCX to PDF</button></a>
      </div>
      <p style="text-align:center; margin-top:2rem;"><a id="backButton">← Back to selection</a></p>
    </main>
    </div>
 
  <footer class="page-footer">
    <p>Developed by <strong>Mubarok Hossen Kamil</strong> • EEE, SUST • Batch 2022</p>
  </footer>

  <script src="https://unpkg.com/pizzip@3.1.7/dist/pizzip.js"></script>
  <script src="https://unpkg.com/docxtemplater@3.30.1/build/docxtemplater.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // === Page Containers ===
      const landingPage = document.getElementById('landingPage');
      const generatorPage = document.getElementById('generatorPage');

      // === Controls ===
      const choiceButtons = document.querySelectorAll('.selection-box');
      const backButton = document.getElementById('backButton');
      
      // === Form Elements ===
      const form = document.getElementById('dataForm');
      const hiddenTemplateInput = document.getElementById('templateFile');
      const labFields = document.getElementById('labFields');
      const assignmentFields = document.getElementById('assignmentFields');
      const status = document.getElementById('status');

      // === NEW: Preview Elements ===
      const preview = {
        deptName: document.getElementById('preview-Dept_Name'),
        expNo: document.getElementById('preview-Exp_No'),
        expName: document.getElementById('preview-Exp_Name'),
        assignmentName: document.getElementById('preview-Assignment_Name'),
        courseCode: document.getElementById('preview-Course_Code'),
        courseTitle: document.getElementById('preview-Course_Title'),
        courseTeacher: document.getElementById('preview-Course_Teacher'),
        teacherDetails: document.getElementById('preview-Course_Teacher_Details'),
        studentName: document.getElementById('preview-Name'),
        regNo: document.getElementById('preview-Reg_No'),
        groupNo: document.getElementById('preview-Group_No'),
        groupNoContainer: document.getElementById('preview-Group_No_Container'),
        labSection: document.getElementById('preview-lab-section'),
        assignmentSection: document.getElementById('preview-assignment-section')
      };

      // === NEW: Update Preview Function ===
      const updatePreview = () => {
        // Get values from form
        const data = {
          Dept_Name: document.getElementById('Dept_Name').value,
          Course_Code: document.getElementById('Course_Code').value,
          Course_Title: document.getElementById('Course_Title').value,
          Course_Teacher: document.getElementById('Course_Teacher').value,
          Course_Teacher_Details: document.getElementById('Course_Teacher_Details').value,
          Reg_No: document.getElementById('Reg_No').value,
          Name: document.getElementById('Name').value,
          Exp_No: document.getElementById('Exp_No').value,
          Group_No: document.getElementById('Group_No').value,
          Exp_Name: document.getElementById('Exp_Name').value,
          Assignment_Name: document.getElementById('Assignment_Name').value
        };

        // Update preview elements, using placeholder if empty
        preview.deptName.textContent = data.Dept_Name || '[Department]';
        preview.expNo.textContent = data.Exp_No || '[No]';
        preview.expName.textContent = data.Exp_Name || '[Experiment Name]';
        preview.assignmentName.textContent = data.Assignment_Name || '[Assignment Title]';
        preview.courseCode.textContent = data.Course_Code || '[Code]';
        preview.courseTitle.textContent = data.Course_Title || '[Title]';
        preview.courseTeacher.textContent = data.Course_Teacher || '[Teacher Name]';
        preview.teacherDetails.textContent = data.Course_Teacher_Details || '[Teacher Designation]';
        preview.studentName.textContent = data.Name || '[Student Name]';
        preview.regNo.textContent = data.Reg_No || '[Reg No]';
        preview.groupNo.textContent = data.Group_No || '[Group]';

        // Show/hide optional fields in preview
        preview.teacherDetails.style.display = data.Course_Teacher_Details ? 'block' : 'none';
        
        // Show group number only if it's a lab report AND has a value
        if (labFields.classList.contains('visible') && data.Group_No) {
          preview.groupNoContainer.classList.remove('hidden');
        } else {
          preview.groupNoContainer.classList.add('hidden');
        }
      };

      // === MODIFIED: Show Generator Function ===
      const showGenerator = (type) => {
        form.reset();
        status.innerHTML = '';
        status.style.backgroundColor = '';
        
        // Hide all form field groups and preview sections
        labFields.classList.remove('visible');
        assignmentFields.classList.remove('visible');
        preview.labSection.classList.add('hidden');
        preview.assignmentSection.classList.add('hidden');

        if (type === 'lab') {
          hiddenTemplateInput.value = 'lab-template.docx';
          labFields.classList.add('visible');
          preview.labSection.classList.remove('hidden'); // Show lab preview
        } else if (type === 'assignment') {
          hiddenTemplateInput.value = 'Assignment-template.docx';
          assignmentFields.classList.add('visible');
          preview.assignmentSection.classList.remove('hidden'); // Show assignment preview
        }

        landingPage.classList.add('hidden');
        generatorPage.classList.remove('hidden');
        window.scrollTo(0, 0);

        updatePreview(); // Call once to set initial placeholder state
      };

      // === MODIFIED: Show Landing Function ===
      const showLanding = () => {
        generatorPage.classList.add('hidden');
        landingPage.classList.remove('hidden');
        window.scrollTo(0, 0);
      };

      // --- Event Listeners ---

      choiceButtons.forEach(button => {
        button.addEventListener('click', () => {
          const choice = button.getAttribute('data-choice');
          showGenerator(choice);
        });
      });

      backButton.addEventListener('click', showLanding);

      // === NEW: Add event listeners to all form inputs ===
      form.querySelectorAll('input[type="text"]').forEach(input => {
        input.addEventListener('input', updatePreview);
      });

      // === UNCHANGED: Form Submit Logic ===
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        status.innerHTML = '<em>Generating your cover page...</em>';
        status.style.color = 'var(--sust-blue)';
        status.style.backgroundColor = '';

        const templateFile = hiddenTemplateInput.value;
        if (!templateFile) {
          status.innerHTML = 'Error: No template selected. Please go back.';
          status.style.color = 'var(--error)';
          status.style.backgroundColor = 'rgba(155, 29, 65, 0.1)';
          return;
        }

        const data = {
          Dept_Name: document.getElementById('Dept_Name').value.trim(),
          Course_Code: document.getElementById('Course_Code').value.trim(),
          Course_Title: document.getElementById('Course_Title').value.trim(),
          Course_Teacher: document.getElementById('Course_Teacher').value.trim(),
          Course_Teacher_Details: document.getElementById('Course_Teacher_Details').value.trim(),
          Reg_No: document.getElementById('Reg_No').value.trim(),
          Name: document.getElementById('Name').value.trim(),
          // Lab Specific
          Exp_No: document.getElementById('Exp_No')?.value.trim() || '',
          Group_No: document.getElementById('Group_No')?.value.trim() || '',
          Exp_Name: document.getElementById('Exp_Name')?.value.trim() || '',
          // Assignment Specific
          Assignment_Name: document.getElementById('Assignment_Name')?.value.trim() || ''
        };

        try {
          const response = await fetch(templateFile);
          if (!response.ok) throw new Error('Template file not found. Ensure template files are in the correct directory.');
          
          const content = await response.arrayBuffer();
          const zip = new PizZip(content);
          const doc = new docxtemplater(zip, { paragraphLoop: true, linebreaks: true });
          doc.render(data);

          const blob = doc.getZip().generate({ type: 'blob', mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });
          const isLabReport = templateFile.includes('lab');
          const fileName = isLabReport
            ? `Lab_Report_${data.Reg_No}_${data.Exp_Name || 'Experiment'}.docx`
            : `Assignment_${data.Reg_No}_${data.Course_Code}.docx`;

          saveAs(blob, fileName.replace(/[^a-zA-Z0-9_-]/g, '_'));

          status.innerHTML = 'Cover page generated & downloaded successfully!';
          status.style.color = 'var(--success)';
          status.style.backgroundColor = 'rgba(45, 106, 79, 0.1)';

          // --- [START] ADDED FOR GOOGLE ANALYTICS EVENT TRACKING ---
          if (typeof gtag === 'function') {
            gtag('event', 'generate_cover_page', {
              'document_type': isLabReport ? 'Lab Report' : 'Assignment',
              'department': data.Dept_Name,
              'course_code': data.Course_Code
            });
          }
          // --- [END] ADDED FOR GOOGLE ANALYTICS EVENT TRACKING ---

        } catch (err) {
          console.error(err);
          status.innerHTML = 'Error: ' + err.message;
          status.style.color = 'var(--error)';
          status.style.backgroundColor = 'rgba(155, 29, 65, 0.1)';
        }
      });
    });
  </script>
  </body>
</html>